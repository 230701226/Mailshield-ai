import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
import joblib
import os

# ✅ Load dataset
df = pd.read_csv("data/known_emails.csv")  # Ensure it has 'subject' and 'body' columns

# ✅ Combine subject and body into a single text column
df['text'] = df['subject'] + " " + df['body']

# ✅ Train TF-IDF vectorizer
vectorizer = TfidfVectorizer(stop_words='english', max_features=1000)
X = vectorizer.fit_transform(df['text'])

# ✅ Ensure models/ directory exists
os.makedirs("models", exist_ok=True)

# ✅ Save vectorizer to models/
joblib.dump(vectorizer, "models/tfidf_vectorizer.pkl")

print("✅ Saved tfidf_vectorizer.pkl in models/")
